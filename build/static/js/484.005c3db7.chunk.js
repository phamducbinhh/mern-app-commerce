"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[484],{8255:function(e,n,r){r(2791);var s=r(184);n.Z=function(){return(0,s.jsx)("div",{className:"section secton-center",children:(0,s.jsx)("div",{className:"loading"})})}},1997:function(e,n,r){r.d(n,{Z:function(){return t}});var s=r(5572),i=r(184);function t(e){return(0,i.jsx)(s.Z,{variant:e.variant||"info",children:e.children})}},9864:function(e,n,r){r.d(n,{E:function(){return t},I:function(){return i}});var s=r(1413),i=function(e,n){switch(n.type){case"FETCH_REQUEST":return(0,s.Z)((0,s.Z)({},e),{},{loading:!0,error:""});case"FETCH_SUCCESS":return(0,s.Z)((0,s.Z)({},e),{},{loading:!1,order:n.payload,error:""});case"FETCH_FAIL":return(0,s.Z)((0,s.Z)({},e),{},{loading:!1,error:n.payload});case"PAY_REQUEST":return(0,s.Z)((0,s.Z)({},e),{},{loadingPay:!0});case"PAY_SUCCESS":return(0,s.Z)((0,s.Z)({},e),{},{loadingPay:!1,successPay:!0});case"PAY_FAIL":return(0,s.Z)((0,s.Z)({},e),{},{loadingPay:!1});case"PAY_RESET":return(0,s.Z)((0,s.Z)({},e),{},{loadingPay:!1,successPay:!1});case"DELIVER_REQUEST":return(0,s.Z)((0,s.Z)({},e),{},{loadingDeliver:!0});case"DELIVER_SUCCESS":return(0,s.Z)((0,s.Z)({},e),{},{loadingDeliver:!1,successDeliver:!0});case"DELIVER_FAIL":return(0,s.Z)((0,s.Z)({},e),{},{loadingDeliver:!1});case"DELIVER_RESET":return(0,s.Z)((0,s.Z)({},e),{},{loadingDeliver:!1,successDeliver:!1});default:return e}},t={loading:!0,order:{},error:"",successPay:!1,loadingPay:!1}},9484:function(e,n,r){r.r(n),r.d(n,{default:function(){return U}});var s,i=r(8214),t=r(5861),a=r(885),c=r(168),d=r(4569),o=r.n(d),l=r(2791),u=r(9743),h=r(2677),p=r(2144),x=r(6871),Z=r(1687),j=r(8255),g=r(1997),v=r(8419),f=r(9864),y=r(6444),E=r(184),m=function(e){var n=e.order;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"\u0110\u01a1n H\xe0ng"}),(0,E.jsxs)(p.Z.Text,{children:[(0,E.jsx)("strong",{children:"S\u1ea3n Ph\u1ea9m:"})," ",n.shippingAddress.fullName," ",(0,E.jsx)("br",{}),(0,E.jsx)("strong",{children:"\u0110\u1ecba Ch\u1ec9: "})," ",n.shippingAddress.address,n.shippingAddress.city,", ",n.shippingAddress.postalCode,",",n.shippingAddress.country]}),n.isDelivered?(0,E.jsxs)(g.Z,{variant:"success",children:["\u0110ang Giao H\xe0ng ",n.deliveredAt]}):(0,E.jsx)(g.Z,{variant:"danger",children:"Ch\u01b0a Giao H\xe0ng"})]})},P=function(e){var n=e.order;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"Thanh To\xe1n"}),(0,E.jsxs)(p.Z.Text,{children:[(0,E.jsx)("strong",{children:"Ph\u01b0\u01a1ng Th\u1ee9c:"})," ",n.paymentMethod]}),n.isPaid?(0,E.jsxs)(g.Z,{variant:"success",children:["\u0110\xe3 Thanh To\xe1n ",n.paidAt]}):(0,E.jsx)(g.Z,{variant:"danger",children:"Ch\u01b0a Thanh To\xe1n"})]})},T=r(4414),S=r(3504),_=function(e){var n=e.order;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"S\u1ea3n Ph\u1ea9m"}),(0,E.jsx)(T.Z,{variant:"flush",children:n.orderItems.map((function(e){return(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{className:"align-items-center",children:[(0,E.jsxs)(h.Z,{md:6,children:[(0,E.jsx)("img",{src:e.image,alt:e.name,className:"image"})," ",(0,E.jsx)(S.Link,{to:"/product/".concat(e.slug),children:e.name})]}),(0,E.jsx)(h.Z,{md:3,children:(0,E.jsx)("span",{children:e.quantity})}),(0,E.jsxs)(h.Z,{md:3,children:["$",e.price]})]})},e._id)}))})]})},C=r(1299),A=r(8412),I=function(e){var n=e.order,r=e.isPending,s=e.loadingPay,i=e.createOrder,t=e.onApprove,a=e.onError,c=e.deliverOrderHandler,d=e.loadingDeliver,o=(0,Z.o)().state.userInfo;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"Th\xe0nh Ti\u1ec1n"}),(0,E.jsxs)(T.Z,{variant:"flush",children:[(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:"Ti\u1ec1n h\xe0ng"}),(0,E.jsxs)(h.Z,{children:["$",n.itemsPrice.toFixed(2)]})]})}),(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:"Ph\xed v\u1eadn chuy\u1ec3n"}),(0,E.jsxs)(h.Z,{children:["$",n.shippingPrice.toFixed(2)]})]})}),(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:"Thu\u1ebf"}),(0,E.jsxs)(h.Z,{children:["$",n.taxPrice.toFixed(2)]})]})}),(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:(0,E.jsx)("strong",{children:"T\u1ed5ng c\u1ed9ng"})}),(0,E.jsx)(h.Z,{children:(0,E.jsxs)("strong",{children:["$",n.totalPrice.toFixed(2)]})})]})}),!n.isPaid&&(0,E.jsxs)(T.Z.Item,{children:[r?(0,E.jsx)(j.Z,{}):(0,E.jsx)("div",{children:(0,E.jsx)(C.ch,{createOrder:i,onApprove:t,onError:a})}),s&&(0,E.jsx)(j.Z,{})]}),o.isAdmin&&n.isPaid&&!n.isDelivered&&(0,E.jsx)(T.Z.Item,{children:(0,E.jsx)("div",{className:"d-grid",children:(0,E.jsx)(A.Z,{type:"button",kind:"ghost",onClick:c,isLoading:d,children:"X\xe1c Nh\u1eadn Giao H\xe0ng"})})})]})]})},D=r(1830),k=r.n(D),R=r(3298),F=r(9085),L=r(925),b=y.ZP.div(s||(s=(0,c.Z)(["\n  min-height: 100vh;\n  padding: 40px;\n  .image {\n    width: 50px;\n    height: 50px;\n    object-fit: cover;\n  }\n"]))),U=function(){var e=(0,Z.o)().state.userInfo,n=(0,x.UO)().id,r=(0,x.s0)(),s=(0,l.useReducer)(f.I,f.E),c=(0,a.Z)(s,2),d=c[0],y=d.loading,T=d.error,S=d.order,A=d.successPay,D=d.loadingPay,U=d.loadingDeliver,w=d.successDeliver,H=c[1],N=(0,C.Up)(),B=(0,a.Z)(N,2),V=B[0].isPending,Y=B[1];(0,l.useEffect)((function(){var s=function(){var r=(0,t.Z)((0,i.Z)().mark((function r(){var s,t;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,H({type:"FETCH_REQUEST"}),r.next=4,o().get("".concat(L.s,"/api/orders/").concat(n),{headers:{authorization:"Bearer ".concat(e.token)}});case 4:s=r.sent,t=s.data,H({type:"FETCH_SUCCESS",payload:t}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),H({type:"FETCH_FAIL",payload:(0,v.by)(r.t0)});case 12:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(){return r.apply(this,arguments)}}();if(!e)return r("/signin");if(!S._id||A||w||S._id&&S._id!==n)s(),A&&H({type:"PAY_RESET"}),w&&H({type:"DELIVER_RESET"});else{var a=function(){var n=(0,t.Z)((0,i.Z)().mark((function n(){var r,s;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o().get("".concat(L.s,"/api/keys/paypal"),{headers:{authorization:"Bearer ".concat(e.token)}});case 2:r=n.sent,s=r.data,Y({type:"resetOptions",value:{"client-id":s,currency:"USD"}}),Y({type:"setLoadingStatus",value:"pending"});case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();a()}}),[S,e,n,r,Y,A,w]);var O=function(){var n=(0,t.Z)((0,i.Z)().mark((function n(){var r,s;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,H({type:"DELIVER_REQUEST"}),n.next=4,o().put("".concat(L.s,"/api/orders/").concat(S._id,"/deliver"),{},{headers:{authorization:"Bearer ".concat(e.token)}});case 4:r=n.sent,s=r.data,H({type:"DELIVER_SUCCESS",payload:s}),k().fire("S\u1ea3n Ph\u1ea9m M\u1edbi!","Giao H\xe0ng Th\xe0nh C\xf4ng","success"),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),F.Am.error((0,v.by)(n.t0)),H({type:"DELIVER_FAIL"});case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(){return n.apply(this,arguments)}}();return y?(0,E.jsx)(j.Z,{}):T?(0,E.jsx)(g.Z,{variant:"danger",children:T}):(0,E.jsxs)(b,{children:[(0,E.jsxs)(R.Z,{children:["\u0110\u01a1n H\xe0ng ",n]}),(0,E.jsxs)(u.Z,{children:[(0,E.jsxs)(h.Z,{md:8,children:[(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(m,{order:S})}),(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(P,{order:S})}),(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(_,{order:S})})]}),(0,E.jsx)(h.Z,{md:4,children:(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(I,{order:S,isPending:V,loadingPay:D,createOrder:function(e,n){return n.order.create({purchase_units:[{amount:{value:S.totalPrice}}]}).then((function(e){return e}))},onApprove:function(n,r){return r.order.capture().then(function(){var n=(0,t.Z)((0,i.Z)().mark((function n(r){var s,t;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,H({type:"PAY_REQUEST"}),n.next=4,o().put("".concat(L.s,"/api/orders/").concat(S._id,"/pay"),r,{headers:{authorization:"Bearer ".concat(e.token)}});case 4:s=n.sent,t=s.data,H({type:"PAY_SUCCESS",payload:t}),k().fire({position:"center",icon:"success",title:"Th\xe0nh C\xf4ng",showConfirmButton:!1,timer:1500}),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),H({type:"PAY_FAIL",payload:(0,v.by)(n.t0)}),k().fire("Failed","error","warning");case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}())},onError:function(e){console.log((0,v.by)(e))},deliverOrderHandler:O,loadingDeliver:U})})})]})]})}}}]);
//# sourceMappingURL=484.005c3db7.chunk.js.map